SELECT
    id,
    case_id,
    name,
    age,
    sex,
    phone_number,
    occupation,
    county,
    country_of_diagnosis,
    nationality,
    subcounty,
    ward,
    village,
    travel_history,
    where_from,
    imported,
    flight_no,
    history_of_contact,
    date_of_arrival,
    symptoms,
    classification,
    onset_date,
    cough,
    fever,
    difficulty_breathing,
    visit_health_facility,
    date_hospital_visit,
    health_facility_name,
    hospitalization,
    admission_date,
    sample_collected,
    date_sample_collected,
    lab_result,
    lab_site,
    date_lab_confirmation,
    date_first_follow_up,
    result_first_follow_up,
    date_second_follow_up,
    result_second_follow_up,
    date_third_follow_up,
    result_third_follow_up,
    outcome,
    date_of_outcome,
    quarantine_facility,
    comobidity,
    management,
    status_need,
    date_announced_by_cs,
    type_of_testing,
    graph_date,
    status,
    others,
    vaccinated,
    dosage,
    (1)::integer AS suspected,
    (case when type_of_testing is not null and type_of_testing <> 'Unknown' then 1 else 0 end)::integer AS tested,
    (case when type_of_testing is not null and type_of_testing <> 'Unknown' and lab_result = 'Positive' then 1 else 0 end)::integer AS confirmed
FROM {{ ref('stg_ears_covid') }}
